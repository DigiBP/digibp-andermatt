<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_11u7hb5" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.0.0-beta.2">
  <bpmn:collaboration id="Collaboration_11h9dju">
    <bpmn:participant id="Participant_1ap8y14" name="&#34;Just-me&#34; order handling process" processRef="Process_Ordering" />
  </bpmn:collaboration>
  <bpmn:process id="Process_Ordering" isExecutable="true">
    <bpmn:laneSet id="LaneSet_0icouuo">
      <bpmn:lane id="Lane_1e4sb46" name="&#34;Just-me&#34; office agent">
        <bpmn:flowNodeRef>IntermediateThrowEvent_0vbxn6s</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_12xl67n</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_1prkqk2</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_1j7p16w</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_0lrce43</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>ExclusiveGateway_06msoyt</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>ExclusiveGateway_1a6ambt</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_1wg61mw</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>EndEvent_1y47752</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_1gsetme</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>ChargeCreditCard</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_0wxvze0</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_067rpz2</bpmn:flowNodeRef>
      </bpmn:lane>
    </bpmn:laneSet>
    <bpmn:sequenceFlow id="SequenceFlow_0nxo40c" sourceRef="IntermediateThrowEvent_0vbxn6s" targetRef="Task_12xl67n" />
    <bpmn:sequenceFlow id="SequenceFlow_0ryqwgl" sourceRef="Task_12xl67n" targetRef="Task_1prkqk2" />
    <bpmn:startEvent id="IntermediateThrowEvent_0vbxn6s" name="Shopping cart received">
      <bpmn:outgoing>SequenceFlow_0nxo40c</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Task_12xl67n" name="Process data" camunda:class="ch.fhnw.digibp.ProcessData">
      <bpmn:incoming>SequenceFlow_0nxo40c</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0ryqwgl</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_1prkqk2" name="Store order information">
      <bpmn:documentation>REST call to integromat storing order</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">www.google.ch</camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="Content-Type">application/json</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="payload">
              <camunda:script scriptFormat="JavaScript">out = JSON.stringify(
{
"orderId": orderId,
"cardNumber": cardNumber,
"totalAmount": totalAmount
}
);</camunda:script>
            </camunda:inputParameter>
            <camunda:inputParameter name="url">https://hook.integromat.com/gsh7vqblzotopwnmy2um46k204icjloz</camunda:inputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0ryqwgl</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1ho2vnh</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="SequenceFlow_1ho2vnh" sourceRef="Task_1prkqk2" targetRef="Task_067rpz2" />
    <bpmn:sequenceFlow id="SequenceFlow_0vu6owj" sourceRef="Task_067rpz2" targetRef="ChargeCreditCard" />
    <bpmn:serviceTask id="Task_1j7p16w" name="Email order to partner" camunda:class="ch.fhnw.digibp.EmailToPartner">
      <bpmn:documentation>integromat storing the email info - step two: mq impl</bpmn:documentation>
      <bpmn:incoming>SequenceFlow_1d8gh6s</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_03l3af8</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_0lrce43" name="Handle payment to partner" camunda:class="ch.fhnw.digibp.PaymentToPartner">
      <bpmn:documentation>just do something??? tbd...
maybe something, the backoffice need to do? so send a message to them?</bpmn:documentation>
      <bpmn:incoming>SequenceFlow_03l3af8</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1d8tslp</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="ExclusiveGateway_06msoyt">
      <bpmn:incoming>SequenceFlow_03uhxkv</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0ke47ms</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_1d8gh6s</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_05heb9k</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:exclusiveGateway id="ExclusiveGateway_1a6ambt">
      <bpmn:incoming>SequenceFlow_0x27abj</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_0atp8io</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_1d8tslp</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_04j78bm</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:manualTask id="Task_1wg61mw" name="Send order to &#34;Just-me&#34; production">
      <bpmn:documentation>probably subtasks or sending message to intermediate event</bpmn:documentation>
      <bpmn:incoming>SequenceFlow_0ke47ms</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0x27abj</bpmn:outgoing>
    </bpmn:manualTask>
    <bpmn:endEvent id="EndEvent_1y47752" name="Order closed">
      <bpmn:incoming>SequenceFlow_1ir6mpp</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="Task_1gsetme" name="Update order status">
      <bpmn:documentation>REST call to integromat updating order row with state</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">https://hook.integromat.com/3x97x2wxfju79g48u633qxmdklaxq3qt</camunda:inputParameter>
            <camunda:inputParameter name="method">GET</camunda:inputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_04j78bm</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1ir6mpp</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="ChargeCreditCard" name="Charge credit card" camunda:class="ch.fhnw.digibp.ChargeCreditCard">
      <bpmn:documentation>integromat call to show, we done something, maybe also mq?
ah, no, send something to this url mocking service</bpmn:documentation>
      <bpmn:incoming>SequenceFlow_0vu6owj</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_03uhxkv</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:manualTask id="Task_0wxvze0" name="Send order to &#34;Just-me&#34;-tailor">
      <bpmn:documentation>probably subtasks or sending message to intermediate event</bpmn:documentation>
      <bpmn:incoming>SequenceFlow_05heb9k</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0atp8io</bpmn:outgoing>
    </bpmn:manualTask>
    <bpmn:sequenceFlow id="SequenceFlow_1d8gh6s" name="Mass-market product" sourceRef="ExclusiveGateway_06msoyt" targetRef="Task_1j7p16w">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${1==3}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_03l3af8" sourceRef="Task_1j7p16w" targetRef="Task_0lrce43" />
    <bpmn:sequenceFlow id="SequenceFlow_1d8tslp" sourceRef="Task_0lrce43" targetRef="ExclusiveGateway_1a6ambt" />
    <bpmn:sequenceFlow id="SequenceFlow_03uhxkv" sourceRef="ChargeCreditCard" targetRef="ExclusiveGateway_06msoyt" />
    <bpmn:sequenceFlow id="SequenceFlow_0ke47ms" name="&#34;Just-me&#34; Fair &#38; eco product" sourceRef="ExclusiveGateway_06msoyt" targetRef="Task_1wg61mw">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${1==2}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_05heb9k" name="&#34;Just-me&#34; tailored product" sourceRef="ExclusiveGateway_06msoyt" targetRef="Task_0wxvze0">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${1==1}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0x27abj" sourceRef="Task_1wg61mw" targetRef="ExclusiveGateway_1a6ambt" />
    <bpmn:sequenceFlow id="SequenceFlow_0atp8io" sourceRef="Task_0wxvze0" targetRef="ExclusiveGateway_1a6ambt" />
    <bpmn:sequenceFlow id="SequenceFlow_04j78bm" sourceRef="ExclusiveGateway_1a6ambt" targetRef="Task_1gsetme" />
    <bpmn:sequenceFlow id="SequenceFlow_1ir6mpp" sourceRef="Task_1gsetme" targetRef="EndEvent_1y47752" />
    <bpmn:serviceTask id="Task_067rpz2" name="Store order items">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">https://hook.integromat.com/52fxw0m2k7omfc8mblfrn06m7nqhcn3i</camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="payload">
              <camunda:script scriptFormat="javascript">out = JSON.stringify(
{
"orderId": orderId,
"description": order.getDescription(),
"url": order.getUrl(),
"price": order.getPrice()
}
);</camunda:script>
            </camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="Content-Type">application/json</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1ho2vnh</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0vu6owj</bpmn:outgoing>
      <bpmn:multiInstanceLoopCharacteristics camunda:collection="orderItems" camunda:elementVariable="order" />
    </bpmn:serviceTask>
  </bpmn:process>
  <bpmn:message id="Message_1xh4ouf" name="startOrderProcess" />
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_11h9dju">
      <bpmndi:BPMNEdge id="SequenceFlow_1d8gh6s_di" bpmnElement="SequenceFlow_1d8gh6s">
        <di:waypoint x="1013" y="268" />
        <di:waypoint x="1013" y="348" />
        <di:waypoint x="1178" y="348" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1068" y="354" width="65" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_1ai6ibz_di" bpmnElement="Task_1j7p16w">
        <dc:Bounds x="1178" y="308" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_05heb9k_di" bpmnElement="SequenceFlow_05heb9k">
        <di:waypoint x="1013" y="218" />
        <di:waypoint x="1013" y="141" />
        <di:waypoint x="1178" y="141" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1052" y="155" width="87" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0ke47ms_di" bpmnElement="SequenceFlow_0ke47ms">
        <di:waypoint x="1038" y="243" />
        <di:waypoint x="1178" y="243" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1064" y="250" width="80" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0x27abj_di" bpmnElement="SequenceFlow_0x27abj">
        <di:waypoint x="1278" y="243" />
        <di:waypoint x="1458" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_04j78bm_di" bpmnElement="SequenceFlow_04j78bm">
        <di:waypoint x="1508" y="243" />
        <di:waypoint x="1566" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0atp8io_di" bpmnElement="SequenceFlow_0atp8io">
        <di:waypoint x="1278" y="141" />
        <di:waypoint x="1483" y="141" />
        <di:waypoint x="1483" y="218" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="EndEvent_1y47752_di" bpmnElement="EndEvent_1y47752">
        <dc:Bounds x="1738" y="225" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1725" y="268" width="64" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_1swuvap_di" bpmnElement="Task_0lrce43">
        <dc:Bounds x="1433" y="308" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1d8tslp_di" bpmnElement="SequenceFlow_1d8tslp">
        <di:waypoint x="1483" y="308" />
        <di:waypoint x="1483" y="268" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Participant_1ap8y14_di" bpmnElement="Participant_1ap8y14" isHorizontal="true">
        <dc:Bounds x="156" y="67" width="1704" height="405" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_1e4sb46_di" bpmnElement="Lane_1e4sb46" isHorizontal="true">
        <dc:Bounds x="186" y="67" width="1674" height="405" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_19rgcrd_di" bpmnElement="ChargeCreditCard">
        <dc:Bounds x="859" y="203" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_03uhxkv_di" bpmnElement="SequenceFlow_03uhxkv">
        <di:waypoint x="959" y="243" />
        <di:waypoint x="988" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ExclusiveGateway_1lqqehn_di" bpmnElement="ExclusiveGateway_06msoyt" isMarkerVisible="true">
        <dc:Bounds x="988" y="218" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0cwfdxe_di" bpmnElement="ExclusiveGateway_1a6ambt" isMarkerVisible="true">
        <dc:Bounds x="1458" y="218" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0nxo40c_di" bpmnElement="SequenceFlow_0nxo40c">
        <di:waypoint x="263" y="243" />
        <di:waypoint x="307" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_03l3af8_di" bpmnElement="SequenceFlow_03l3af8">
        <di:waypoint x="1278" y="348" />
        <di:waypoint x="1433" y="348" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ManualTask_1eilasx_di" bpmnElement="Task_0wxvze0">
        <dc:Bounds x="1178" y="101" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ManualTask_0fj2aov_di" bpmnElement="Task_1wg61mw">
        <dc:Bounds x="1178" y="203" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_02f3t17_di" bpmnElement="Task_1prkqk2">
        <dc:Bounds x="434" y="203" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1ir6mpp_di" bpmnElement="SequenceFlow_1ir6mpp">
        <di:waypoint x="1666" y="243" />
        <di:waypoint x="1738" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_0li5fnj_di" bpmnElement="Task_1gsetme">
        <dc:Bounds x="1566" y="203" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="StartEvent_1y75hpt_di" bpmnElement="IntermediateThrowEvent_0vbxn6s">
        <dc:Bounds x="227" y="225" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="210" y="268" width="69" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_0ujsfgr_di" bpmnElement="Task_12xl67n">
        <dc:Bounds x="307" y="203" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0ryqwgl_di" bpmnElement="SequenceFlow_0ryqwgl">
        <di:waypoint x="407" y="243" />
        <di:waypoint x="434" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1ho2vnh_di" bpmnElement="SequenceFlow_1ho2vnh">
        <di:waypoint x="534" y="243" />
        <di:waypoint x="647" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0vu6owj_di" bpmnElement="SequenceFlow_0vu6owj">
        <di:waypoint x="747" y="243" />
        <di:waypoint x="859" y="243" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_1oskl2t_di" bpmnElement="Task_067rpz2">
        <dc:Bounds x="647" y="203" width="100" height="80" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
